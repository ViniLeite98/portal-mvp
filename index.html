async function carregarDashboard() {

  const { data, error } = await supabaseClient
    .from("terapeutas")
    .select("nome_profissional,hora_entrada,hora_saida,status")
    .eq("status","Ativo");

  if (error) {
    console.error("Erro Supabase:", error);
    return;
  }

  // ========= CONTADOR =========
  document.getElementById("totalEquipe").innerText = data.length;

  // ========= CARGA HORÁRIA (ORDENADA MAIOR → MENOR) =========
  const cargaDiv = document.getElementById("cargaHoraria");
  cargaDiv.innerHTML = "";

  const cargas = [];

  data.forEach(t => {
    if (!t.hora_entrada || !t.hora_saida) return;

    const inicio = new Date(`1970-01-01T${t.hora_entrada}`);
    const fim = new Date(`1970-01-01T${t.hora_saida}`);

    const diffMs = fim - inicio;

    const totalMin = diffMs / 60000;
    const horas = Math.floor(totalMin / 60);
    const minutos = totalMin % 60;

    cargas.push({
      nome: t.nome_profissional,
      totalMin,
      texto: `${horas}:${minutos.toString().padStart(2,'0')}`
    });
  });

  // Ordena da maior carga para menor
  cargas.sort((a, b) => b.totalMin - a.totalMin);

  cargas.forEach(c => {
    cargaDiv.innerHTML += 
      `<p>${c.nome}: ${c.texto} horas</p>`;
  });

  // ========= FORÇA DE TRABALHO =========
  const inicioDia = 9;
  const fimDia = 21;

  const contagem = {};

  for (let h = inicioDia; h <= fimDia; h++) {
    contagem[h] = 0;
  }

  data.forEach(t => {
    if (!t.hora_entrada || !t.hora_saida) return;

    const [horaIni, minIni] = t.hora_entrada.split(":").map(Number);
    const [horaFim, minFim] = t.hora_saida.split(":").map(Number);

    for (let h = inicioDia; h <= fimDia; h++) {

      const inicioSlot = h * 60;
      const fimSlot = (h + 1) * 60;

      const inicioTrab = horaIni * 60 + minIni;
      const fimTrab = horaFim * 60 + minFim;

      if (inicioTrab < fimSlot && fimTrab > inicioSlot) {
        contagem[h]++;
      }
    }
  });

  const barsDiv = document.getElementById("bars");
  const hoursDiv = document.getElementById("hours");

  barsDiv.innerHTML = "";
  hoursDiv.innerHTML = "";

  Object.keys(contagem).forEach(h => {

    const quantidade = contagem[h];
    const altura = quantidade * 30;

    barsDiv.innerHTML += `
      <div class="bar" style="height:${altura}px">
        ${quantidade}
      </div>
    `;

    hoursDiv.innerHTML += `<span>${h}:00</span>`;
  });

}
