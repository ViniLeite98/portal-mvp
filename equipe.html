<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portal MVP ‚Ä¢ Equipe</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
<header>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <h1>Portal MVP</h1>
          <div class="muted">Gest√£o da Equipe ‚Ä¢ Terapeutas, hor√°rios e folgas</div>
        </div>
      </div>

      <div class="kpi">
        <span class="pill">Terapeutas ativas: <strong id="kpiTherapistsActive">0</strong></span>
        <span class="pill">Total solicita√ß√µes: <strong id="kpiTotal">0</strong></span>
        <span class="pill">Abertas: <strong id="kpiOpen">0</strong></span>
        <span class="pill">Aprovadas: <strong id="kpiApproved">0</strong></span>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="grid">
    <!-- MENU -->
    <section class="card">
      <div class="hd"><div class="muted">Navega√ß√£o</div></div>
      <div class="bd">
        <div class="nav">
          <a class="btn" href="./index.html">In√≠cio</a>
          <a class="btn" href="./materiais.html">Materiais</a>
          <a class="btn" href="./solicitacoes.html">Solicita√ß√µes</a>
          <a class="btn primary" href="./equipe.html">Equipe</a>
          <a class="btn" href="./terapeutas.html">Terapeutas</a>
          <a class="btn" href="./governanca.html">Governan√ßa</a>
        </div>
      </div>
      <div class="ft">
        <button class="btn danger small" id="btnReset" type="button">Zerar dados</button>
        <span class="note">Somente local</span>
      </div>
    </section>

    <!-- CONTE√öDO -->
    <section class="card">
      <div class="hd" style="display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h2 style="margin:0;font-size:18px">Gest√£o da Equipe</h2>
          <div class="muted">Gerir informa√ß√µes das terapeutas, hor√°rios e folgas.</div>
          <div class="note" style="margin-top:8px"><span id="activeCount">0</span> terapeutas ativas</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <button class="btn primary" id="btnNew" type="button">Ôºã Nova Terapeuta</button>
          <button class="btn" id="btnRefresh" type="button">Atualizar</button>
        </div>
      </div>

      <div class="bd">
        <div id="jsWarn" class="note" style="display:none;color:var(--bad);margin-bottom:12px"></div>

        <!-- LISTA -->
        <div class="card" style="box-shadow:none">
          <div class="bd">
            <table>
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>Folga semanal?</th>
                  <th>Dia da folga</th>
                  <th>Data de In√≠cio</th>
                  <th>Hor√°rio</th>
                  <th style="text-align:right">A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="rows"></tbody>
            </table>
            <div class="note" id="emptyMsg" style="margin-top:10px"></div>
          </div>
        </div>

        <div class="sep"></div>

        <!-- FORM -->
        <div id="formCard" class="card" style="display:none;box-shadow:none">
          <div class="hd">
            <h3 style="margin:0;font-size:18px" id="formTitle">Nova Terapeuta</h3>
            <div class="muted">Preencha os dados da terapeuta</div>
          </div>

          <div class="bd">
            <div class="note" id="formMsg" style="margin-bottom:12px"></div>

            <div class="row2">
              <div>
                <label for="fullName">Nome Completo *</label>
                <input id="fullName" />
              </div>
              <div>
                <label for="profName">Nome profissional *</label>
                <input id="profName" />
              </div>
            </div>

            <div class="sep"></div>

            <div class="row2" style="grid-template-columns:0.9fr 0.7fr 1.2fr 0.8fr">
              <div>
                <label for="birthDate">Data de Nascimento *</label>
                <input id="birthDate" type="date" />
              </div>
              <div>
                <label for="cpf">CPF * (11 d√≠gitos)</label>
                <input id="cpf" maxlength="11" inputmode="numeric" placeholder="Somente n√∫meros" />
              </div>
              <div>
                <label for="email">Email *</label>
                <input id="email" type="email" placeholder="exemplo@dominio.com" />
              </div>
              <div>
                <label for="unit">Unidade *</label>
                <input id="unit" />
              </div>
            </div>

            <div class="sep"></div>

            <div class="row2" style="grid-template-columns:1.6fr 0.7fr 0.7fr">
              <div>
                <label for="address">Endere√ßo</label>
                <input id="address" />
              </div>
              <div>
                <label for="contact">Contato *</label>
                <input id="contact" />
              </div>
              <div>
                <label for="emergencyContact">Contato Emerg√™ncia</label>
                <input id="emergencyContact" />
              </div>
            </div>

            <div class="sep"></div>

            <div class="row2" style="grid-template-columns:0.9fr 1.2fr 0.7fr 0.7fr">
              <div>
                <label for="pixKeyType">Tipo de Chave Pix</label>
                <select id="pixKeyType">
                  <option value=""></option>
                  <option value="CPF">CPF</option>
                  <option value="Email">Email</option>
                  <option value="Telefone">Telefone</option>
                  <option value="Aleat√≥ria">Aleat√≥ria</option>
                </select>
              </div>
              <div>
                <label for="pixKey">Chave Pix</label>
                <input id="pixKey" />
              </div>
              <div>
                <label for="hasWeeklyOff">Tem Folga semanal? *</label>
                <select id="hasWeeklyOff">
                  <option>Sim</option>
                  <option>N√£o</option>
                </select>
              </div>
              <div>
                <label for="weeklyOffDay">Dia da Folga</label>
                <select id="weeklyOffDay">
                  <option value=""></option>
                  <option>Segunda</option>
                  <option>Ter√ßa</option>
                  <option>Quarta</option>
                  <option>Quinta</option>
                  <option>Sexta</option>
                  <option>S√°bado</option>
                  <option>Domingo</option>
                </select>
              </div>
            </div>

            <div class="sep"></div>

            <div class="row2" style="grid-template-columns:0.9fr 0.9fr 1.0fr 0.8fr 0.8fr">
              <div>
                <label for="startTime">Hor√°rio de Entrada *</label>
                <input id="startTime" type="time" />
              </div>
              <div>
                <label for="endTime">Hor√°rio de Sa√≠da *</label>
                <input id="endTime" type="time" />
              </div>
              <div>
                <label for="startDate">Data de In√≠cio *</label>
                <input id="startDate" type="date" />
              </div>
              <div>
                <label for="bloodType">Tipo Sangu√≠neo</label>
                <select id="bloodType">
                  <option value=""></option>
                  <option>A+</option><option>A-</option>
                  <option>B+</option><option>B-</option>
                  <option>AB+</option><option>AB-</option>
                  <option>O+</option><option>O-</option>
                </select>
              </div>
              <div>
                <label>Status *</label>
                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:6px">
                  <label style="display:flex;gap:6px;align-items:center;margin:0">
                    <input type="radio" name="status" value="Ativo" checked> Ativo
                  </label>
                  <label style="display:flex;gap:6px;align-items:center;margin:0">
                    <input type="radio" name="status" value="Inativo"> Inativo
                  </label>
                </div>
              </div>
            </div>

            <div class="sep"></div>

            <!-- CERTIFICA√á√ïES (configur√°vel + adiciona mais) -->
            <h3 style="margin:0 0 6px 0;font-size:18px">Certifica√ß√µes</h3>
            <div class="muted" style="margin-bottom:10px">Voc√™ pode adicionar novas certifica√ß√µes abaixo.</div>

            <div class="row2" style="grid-template-columns:2fr 1fr;align-items:end">
              <div>
                <label for="newCertName">Adicionar certifica√ß√£o</label>
                <input id="newCertName" placeholder="Ex.: Certifica√ß√£o X" />
              </div>
              <div>
                <button class="btn" id="btnAddCert" type="button">Adicionar</button>
              </div>
            </div>

            <div class="sep"></div>

            <div id="certGrid" class="row2" style="grid-template-columns:repeat(3, 1fr)"></div>

            <div class="sep"></div>

            <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
              <button class="btn primary" id="btnSave" type="button">Salvar</button>
              <button class="btn" id="btnCancel" type="button">Cancelar</button>
              <span class="note" id="saveMsg"></span>
            </div>

            <div class="sep"></div>
            <div class="note">
              Dica de governan√ßa: CPF √© tratado como identificador √∫nico. Altera√ß√µes ficam em <code>updated_at</code>.
            </div>
          </div>
        </div>

      </div>
    </section>
  </div>
</main>

<script src="./app.js?v=13"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const $ = (id) => document.getElementById(id);

  // ---- fallback (evita ‚Äúinterromper‚Äù se app.js falhar) ----
  const warn = (t) => { $("jsWarn").style.display="block"; $("jsWarn").textContent=t; };
  const fallbackApp = {
    TH_KEY: "portal_mvp_therapists_v1",
    REQ_KEY: "portal_mvp_requests_v1",
    CERT_KEY: "portal_mvp_cert_catalog_v1",
    nowISO: () => new Date().toISOString(),
    uid: () => (crypto && crypto.randomUUID ? crypto.randomUUID() : String(Math.random()).slice(2) + String(Date.now())),
    loadJSON: (k, fb) => { try { const v = localStorage.getItem(k); return v ? JSON.parse(v) : fb; } catch { return fb; } },
    saveJSON: (k, v) => localStorage.setItem(k, JSON.stringify(v)),
    escapeHtml: (s) => String(s ?? "").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])),
  };

  const A = window.App || fallbackApp;
  if (!window.App) warn("Aviso: app.js n√£o carregou (vou rodar em modo fallback). Verifique se o arquivo se chama 'app.js' e est√° na raiz.");

  // ---- reset button ----
  const resetBtn = $("btnReset");
  resetBtn.addEventListener("click", () => {
    if (!confirm("Zerar dados locais?")) return;
    localStorage.removeItem(A.TH_KEY);
    localStorage.removeItem(A.REQ_KEY);
    localStorage.removeItem(A.CERT_KEY);
    renderAll();
  });

  // ---- helpers ----
  const onlyDigits = (s) => String(s||"").replace(/\D+/g, "");
  const isValidEmail = (e) => {
    e = String(e||"").trim();
    if (!e.includes("@")) return false;
    const dom = e.split("@").slice(-1)[0] || "";
    return dom.includes(".");
  };
  const todayYYYYMMDD = () => {
    const d = new Date();
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,"0");
    const dd = String(d.getDate()).padStart(2,"0");
    return `${y}-${m}-${dd}`;
  };
  const timeToMin = (t) => {
    const m = String(t||"").match(/^(\d{2}):(\d{2})$/);
    if (!m) return null;
    return (+m[1])*60 + (+m[2]);
  };
  const fmtDateBR = (iso) => {
    const s = String(iso||"").trim();
    const m = s.match(/^(\d{4})-(\d{2})-(\d{2})$/);
    if (!m) return s || "";
    const y = +m[1], mo = +m[2], d = +m[3];
    const meses = ["janeiro","fevereiro","mar√ßo","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];
    return `${d} ${meses[mo-1]} ${y}`;
  };
  const makeHorario = (a,b) => {
    a = String(a||"").trim(); b = String(b||"").trim();
    if (a && b) return `${a}‚Äì${b}`;
    return a || b || "";
  };
  const isAtivo = (status) => {
    const s = String(status||"").trim().toLowerCase();
    return s === "" || s === "ativo";
  };

  // ---- data access ----
  function loadTherapists(){ return A.loadJSON(A.TH_KEY, []); }
  function saveTherapists(items){ A.saveJSON(A.TH_KEY, items); }
  function loadCertCatalog(){
    const def = [
      "Massagem Nuru",
      "Massagem Viv√™ncia",
      "Podolatria",
      "Massagem Casais",
      "Massagem Feminina"
    ];
    const v = A.loadJSON(A.CERT_KEY, null);
    if (!v || !Array.isArray(v) || !v.length){
      A.saveJSON(A.CERT_KEY, def);
      return def;
    }
    return v;
  }
  function saveCertCatalog(list){ A.saveJSON(A.CERT_KEY, list); }

  // ---- state ----
  let editId = null;

  // ---- elements ----
  const rows = $("rows");
  const emptyMsg = $("emptyMsg");
  const activeCount = $("activeCount");

  const formCard = $("formCard");
  const formTitle = $("formTitle");
  const formMsg = $("formMsg");
  const saveMsg = $("saveMsg");

  // form fields
  const fullName = $("fullName");
  const profName = $("profName");
  const birthDate = $("birthDate");
  const cpf = $("cpf");
  const email = $("email");
  const unit = $("unit");
  const address = $("address");
  const contact = $("contact");
  const emergencyContact = $("emergencyContact");
  const pixKeyType = $("pixKeyType");
  const pixKey = $("pixKey");
  const hasWeeklyOff = $("hasWeeklyOff");
  const weeklyOffDay = $("weeklyOffDay");
  const startTime = $("startTime");
  const endTime = $("endTime");
  const startDate = $("startDate");
  const bloodType = $("bloodType");

  const newCertName = $("newCertName");
  const btnAddCert = $("btnAddCert");
  const certGrid = $("certGrid");

  // ---- kpis topo (se app.js tiver, ok; se n√£o, fazemos b√°sico) ----
  function renderKpisFallback(){
    const th = loadTherapists();
    const req = A.loadJSON(A.REQ_KEY, []);
    const active = th.filter(t => isAtivo(t.status)).length;
    $("kpiTherapistsActive").textContent = String(active);

    $("kpiTotal").textContent = String(req.length);
    $("kpiOpen").textContent = String(req.filter(r => r.status === "SUBMITTED").length);
    $("kpiApproved").textContent = String(req.filter(r => r.status === "APPROVED").length);
  }
  function renderTop(){
    try { window.App && App.renderTherapistsKpis && App.renderTherapistsKpis(); } catch(e){}
    try { window.App && App.renderKpis && App.renderKpis(); } catch(e){}
    if (!window.App) renderKpisFallback();
    // tamb√©m garante contagem do card
    const th = loadTherapists();
    activeCount.textContent = String(th.filter(t => isAtivo(t.status)).length);
  }

  // ---- list render ----
  function renderList(){
    const th = loadTherapists();
    const view = th.filter(t => isAtivo(t.status));
    activeCount.textContent = String(view.length);

    rows.innerHTML = "";
    if (!view.length){
      emptyMsg.textContent = "Sem terapeutas ativas cadastradas.";
      return;
    }
    emptyMsg.textContent = "";

    // ordena por nome profissional
    view.sort((a,b) => String(a.profName||"").localeCompare(String(b.profName||""), "pt-BR"));

    for (const t of view){
      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td>${A.escapeHtml(t.profName || "")}</td>
        <td>${A.escapeHtml(t.hasWeeklyOff || "")}</td>
        <td>${A.escapeHtml(t.weeklyOffDay || "")}</td>
        <td>${A.escapeHtml(fmtDateBR(t.startDate || ""))}</td>
        <td>${A.escapeHtml(makeHorario(t.startTime, t.endTime))}</td>
        <td style="text-align:right;white-space:nowrap">
          <button class="btn small" type="button" data-edit="${t.id}">‚úèÔ∏è</button>
          <button class="btn danger small" type="button" data-del="${t.id}">üóëÔ∏è</button>
        </td>
      `;

      tr.querySelector(`[data-edit="${t.id}"]`).addEventListener("click", () => openEdit(t.id));
      tr.querySelector(`[data-del="${t.id}"]`).addEventListener("click", () => delTherapist(t.id));

      rows.appendChild(tr);
    }
  }

  // ---- form (certs) ----
  function renderCertGrid(selectedMap){
    const catalog = loadCertCatalog();
    certGrid.innerHTML = "";
    for (const name of catalog){
      const id = "cert_" + name.replace(/\s+/g,"_").replace(/[^\w_]/g,"");
      const checked = !!(selectedMap && selectedMap[name]);
      const wrap = document.createElement("div");
      wrap.innerHTML = `
        <label style="display:flex;gap:8px;align-items:center;margin:0">
          <input type="checkbox" id="${A.escapeHtml(id)}" ${checked ? "checked" : ""}/>
          <span>${A.escapeHtml(name)}</span>
        </label>
      `;
      certGrid.appendChild(wrap);
    }
  }

  function getCertSelection(){
    const catalog = loadCertCatalog();
    const out = {};
    for (const name of catalog){
      const id = "cert_" + name.replace(/\s+/g,"_").replace(/[^\w_]/g,"");
      const el = document.getElementById(id);
      out[name] = !!(el && el.checked);
    }
    return out;
  }

  btnAddCert.addEventListener("click", () => {
    const name = String(newCertName.value||"").trim();
    if (!name) return;
    const catalog = loadCertCatalog();
    if (catalog.map(x => x.toLowerCase()).includes(name.toLowerCase())){
      newCertName.value = "";
      return;
    }
    catalog.push(name);
    saveCertCatalog(catalog);
    newCertName.value = "";
    // mant√©m sele√ß√µes atuais
    const sel = getCertSelection();
    sel[name] = false;
    renderCertGrid(sel);
  });

  // ---- form open/close ----
  function openNew(){
    editId = null;
    formTitle.textContent = "Nova Terapeuta";
    formMsg.textContent = "";
    formMsg.style.color = "";
    saveMsg.textContent = "";
    saveMsg.style.color = "";

    fullName.value = "";
    profName.value = "";
    birthDate.value = "2000-01-01";
    cpf.value = "";
    email.value = "";
    unit.value = "";
    address.value = "";
    contact.value = "";
    emergencyContact.value = "";
    pixKeyType.value = "";
    pixKey.value = "";
    hasWeeklyOff.value = "Sim";
    weeklyOffDay.value = "";
    startTime.value = "10:00";
    endTime.value = "18:00";
    startDate.value = todayYYYYMMDD();
    bloodType.value = "";
    document.querySelectorAll('input[name="status"]').forEach(r => r.checked = (r.value === "Ativo"));

    renderCertGrid({}); // default false

    formCard.style.display = "block";
    formCard.scrollIntoView({behavior:"smooth", block:"start"});
  }

  function openEdit(id){
    const th = loadTherapists();
    const t = th.find(x => x.id === id);
    if (!t) return;

    editId = id;
    formTitle.textContent = "Editar Terapeuta";
    formMsg.textContent = "";
    formMsg.style.color = "";
    saveMsg.textContent = "";
    saveMsg.style.color = "";

    fullName.value = t.fullName || "";
    profName.value = t.profName || "";
    birthDate.value = (t.birthDate || "2000-01-01");
    cpf.value = onlyDigits(t.cpf || "");
    email.value = t.email || "";
    unit.value = t.unit || "";
    address.value = t.address || "";
    contact.value = t.contact || "";
    emergencyContact.value = t.emergencyContact || "";
    pixKeyType.value = t.pixKeyType || "";
    pixKey.value = t.pixKey || "";
    hasWeeklyOff.value = t.hasWeeklyOff || "Sim";
    weeklyOffDay.value = t.weeklyOffDay || "";
    startTime.value = t.startTime || "10:00";
    endTime.value = t.endTime || "18:00";
    startDate.value = (t.startDate || todayYYYYMMDD());
    bloodType.value = t.bloodType || "";

    const st = (t.status || "Ativo");
    document.querySelectorAll('input[name="status"]').forEach(r => r.checked = (r.value === st));

    renderCertGrid(t.certs || {});

    formCard.style.display = "block";
    formCard.scrollIntoView({behavior:"smooth", block:"start"});
  }

  function closeForm(){
    formCard.style.display = "none";
    editId = null;
  }

  // ---- validations + save ----
  function save(){
    formMsg.textContent = "";
    formMsg.style.color = "";
    saveMsg.textContent = "";
    saveMsg.style.color = "";

    const errors = [];

    const vFull = String(fullName.value||"").trim();
    const vProf = String(profName.value||"").trim();
    const vCpf = onlyDigits(cpf.value||"");
    const vEmail = String(email.value||"").trim();
    const vUnit = String(unit.value||"").trim();
    const vContact = String(contact.value||"").trim();

    const vHasOff = String(hasWeeklyOff.value||"").trim();
    const vOffDay = String(weeklyOffDay.value||"").trim();
    const vPixType = String(pixKeyType.value||"").trim();
    const vPix = String(pixKey.value||"").trim();

    const vStart = String(startTime.value||"").trim();
    const vEnd = String(endTime.value||"").trim();

    if (!vFull) errors.push("Nome Completo √© obrigat√≥rio.");
    if (!vProf) errors.push("Nome profissional √© obrigat√≥rio.");

    if (vCpf.length !== 11) errors.push("CPF deve ter exatamente 11 d√≠gitos.");
    if (!vEmail) errors.push("Email √© obrigat√≥rio.");
    else if (!isValidEmail(vEmail)) errors.push("Email inv√°lido (precisa ter @ e dom√≠nio com .).");

    if (!vUnit) errors.push("Unidade √© obrigat√≥ria.");
    if (!vContact) errors.push("Contato √© obrigat√≥rio.");

    if (vHasOff === "Sim" && !vOffDay) errors.push("Se tem folga semanal, selecione o Dia da Folga.");
    if (vPixType && !vPix) errors.push("Se Tipo de Chave Pix foi selecionado, preencha a Chave Pix.");

    const mStart = timeToMin(vStart);
    const mEnd = timeToMin(vEnd);
    if (mStart == null || mEnd == null) errors.push("Hor√°rios inv√°lidos.");
    else if (mEnd <= mStart) errors.push("Hor√°rio de Sa√≠da deve ser ap√≥s o Hor√°rio de Entrada.");

    // CPF √∫nico (governan√ßa)
    const th = loadTherapists();
    const cpfExists = th.some(x => onlyDigits(x.cpf||"") === vCpf && x.id !== editId);
    if (cpfExists) errors.push("J√° existe uma terapeuta cadastrada com esse CPF.");

    if (errors.length){
      formMsg.textContent = errors.join(" ");
      formMsg.style.color = "var(--bad)";
      return;
    }

    const status = (document.querySelector('input[name="status"]:checked') || {}).value || "Ativo";
    const certs = getCertSelection();

    const row = {
      id: editId || A.uid().slice(0,8),
      fullName: vFull,
      profName: vProf,
      birthDate: String(birthDate.value||"").trim(),
      cpf: vCpf,
      email: vEmail,
      unit: vUnit,
      address: String(address.value||"").trim(),
      contact: vContact,
      emergencyContact: String(emergencyContact.value||"").trim(),
      pixKeyType: vPixType,
      pixKey: vPix,
      hasWeeklyOff: vHasOff,
      weeklyOffDay: (vHasOff === "Sim" ? vOffDay : ""),
      startTime: vStart,
      endTime: vEnd,
      startDate: String(startDate.value||"").trim(),
      bloodType: String(bloodType.value||"").trim(),
      status: status,
      certs: certs,
      updated_at: A.nowISO(),
    };

    if (!editId) row.created_at = A.nowISO();

    // save
    if (!editId){
      th.push(row);
      saveTherapists(th);
      saveMsg.textContent = "Terapeuta cadastrada.";
      saveMsg.style.color = "var(--good)";
    } else {
      const idx = th.findIndex(x => x.id === editId);
      if (idx >= 0){
        // preserva created_at se existir
        row.created_at = th[idx].created_at || row.created_at || "";
        th[idx] = row;
        saveTherapists(th);
        saveMsg.textContent = "Altera√ß√µes salvas.";
        saveMsg.style.color = "var(--good)";
      }
    }

    renderAll();
    closeForm();
  }

  function delTherapist(id){
    if (!confirm("Excluir essa terapeuta?")) return;
    const th = loadTherapists().filter(x => x.id !== id);
    saveTherapists(th);
    renderAll();
  }

  // ---- events ----
  $("btnNew").addEventListener("click", openNew);
  $("btnRefresh").addEventListener("click", renderAll);
  $("btnCancel").addEventListener("click", closeForm);
  $("btnSave").addEventListener("click", save);

  // ---- render all ----
  function renderAll(){
    renderTop();
    renderList();
  }

  renderAll();
});
</script>
</body>
</html>
