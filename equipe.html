<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Equipe</title>

  <link rel="stylesheet" href="styles.css">
  <script src="app.js" defer></script>

  <style>
    body { background:#f6f7fb; }

    .card {
      background:#fff;
      border-radius:18px;
      padding:20px;
      margin-bottom:16px;
      box-shadow:0 1px 6px rgba(0,0,0,.06);
    }

    .header {
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .kpi {
      font-size:32px;
      font-weight:700;
    }

    .sub {
      color:#6b7280;
      font-size:13px;
    }

    table {
      width:100%;
      border-collapse:collapse;
      font-size:14px;
    }

    th {
      text-align:left;
      padding:10px;
      border-bottom:1px solid #e5e7eb;
    }

    td {
      padding:10px;
      border-bottom:1px solid #f1f5f9;
    }

    .btn {
      background:#4f46e5;
      color:#fff;
      border:none;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
    }

    .btn.secondary {
      background:#e5e7eb;
      color:#111;
    }

    .actions button {
      background:none;
      border:none;
      cursor:pointer;
      font-size:16px;
    }

    .grid {
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:14px;
    }

    label {
      font-size:12px;
      color:#374151;
    }

    input, select {
      width:100%;
      padding:8px;
      border-radius:8px;
      border:1px solid #d1d5db;
    }

    .section {
      margin-top:20px;
      padding-top:10px;
      border-top:1px solid #e5e7eb;
    }

    .hidden { display:none; }
  </style>
</head>

<body>

<div id="sidebar-container"></div>

<main class="content">

  <!-- KPI -->
  <div class="card">
    <div class="header">
      <div>
        <h2>üë• Lista de Terapeutas</h2>
        <div class="sub" id="kpiAtivas">0 terapeutas ativas</div>
      </div>
      <button class="btn" onclick="openForm()">Ôºã Nova Terapeuta</button>
    </div>
  </div>

  <!-- TABELA -->
  <div class="card">
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Folga?</th>
          <th>Dia</th>
          <th>Data in√≠cio</th>
          <th>Hor√°rio</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </div>

  <!-- FORMUL√ÅRIO -->
  <div class="card hidden" id="formCard">
    <h3 id="formTitle">Nova Terapeuta</h3>

    <div class="grid">
      <div><label>Nome Completo</label><input id="nomeCompleto"></div>
      <div><label>Nome Profissional</label><input id="nomeProf"></div>
      <div><label>CPF</label><input id="cpf"></div>

      <div><label>Email</label><input id="email"></div>
      <div><label>Unidade</label><input id="unidade"></div>
      <div><label>Contato</label><input id="contato"></div>

      <div><label>Contato Emerg√™ncia</label><input id="contatoEmerg"></div>
      <div><label>Endere√ßo</label><input id="endereco"></div>
      <div><label>Data de Nascimento</label><input type="date" id="dataNasc"></div>
    </div>

    <div class="section grid">
      <div>
        <label>Tem folga semanal?</label>
        <select id="folga">
          <option>Sim</option>
          <option>N√£o</option>
        </select>
      </div>

      <div>
        <label>Dia da Folga</label>
        <select id="diaFolga">
          <option></option>
          <option>Segunda</option>
          <option>Ter√ßa</option>
          <option>Quarta</option>
          <option>Quinta</option>
          <option>Sexta</option>
          <option>S√°bado</option>
          <option>Domingo</option>
        </select>
      </div>

      <div>
        <label>Status</label>
        <select id="status">
          <option>Ativo</option>
          <option>Inativo</option>
        </select>
      </div>
    </div>

    <div class="section grid">
      <div><label>Hor√°rio Entrada</label><input type="time" id="hEntrada"></div>
      <div><label>Hor√°rio Sa√≠da</label><input type="time" id="hSaida"></div>
      <div><label>Data de In√≠cio</label><input type="date" id="dataInicio"></div>
    </div>

    <div class="section">
      <h4>Certifica√ß√µes</h4>
      <div class="grid">
        <label><input type="checkbox" id="certNuru"> Massagem Nuru</label>
        <label><input type="checkbox" id="certViv"> Massagem Viv√™ncia</label>
        <label><input type="checkbox" id="certPodo"> Podolatria</label>
        <label><input type="checkbox" id="certCasais"> Massagem Casais</label>
        <label><input type="checkbox" id="certFem"> Massagem Feminina</label>
      </div>
    </div>

    <br>
    <button class="btn" onclick="save()">Salvar</button>
    <button class="btn secondary" onclick="closeForm()">Cancelar</button>
  </div>

</main>

<script>
fetch("sidebar.html")
  .then(r=>r.text())
  .then(t=>document.getElementById("sidebar-container").innerHTML=t);

const KEY="portal_mvp_team_v1";
let editId=null;

function load(){return JSON.parse(localStorage.getItem(KEY)||"[]")}
function saveStore(v){localStorage.setItem(KEY,JSON.stringify(v))}

function render(){
  const data=load();
  const tbody=document.getElementById("lista");
  tbody.innerHTML="";
  const ativas=data.filter(t=>t.status==="Ativo");
  document.getElementById("kpiAtivas").innerText=`${ativas.length} terapeutas ativas`;

  data.forEach(t=>{
    tbody.innerHTML+=`
      <tr>
        <td>${t.nomeProf}</td>
        <td>${t.folga}</td>
        <td>${t.diaFolga||"-"}</td>
        <td>${t.dataInicio||"-"}</td>
        <td>${t.hEntrada||""}‚Äì${t.hSaida||""}</td>
        <td class="actions">
          <button onclick="edit('${t.id}')">‚úèÔ∏è</button>
          <button onclick="del('${t.id}')">üóëÔ∏è</button>
        </td>
      </tr>`;
  });
}

function openForm(){document.getElementById("formCard").classList.remove("hidden")}
function closeForm(){document.getElementById("formCard").classList.add("hidden");editId=null}

function save(){
  const d=load();
  const t={
    id:editId||crypto.randomUUID(),
    nomeCompleto:nomeCompleto.value,
    nomeProf:nomeProf.value,
    cpf:cpf.value,
    email:email.value,
    unidade:unidade.value,
    contato:contato.value,
    contatoEmerg:contatoEmerg.value,
    endereco:endereco.value,
    dataNasc:dataNasc.value,
    folga:folga.value,
    diaFolga:diaFolga.value,
    status:status.value,
    hEntrada:hEntrada.value,
    hSaida:hSaida.value,
    dataInicio:dataInicio.value,
    certNuru:certNuru.checked,
    certViv:certViv.checked,
    certPodo:certPodo.checked,
    certCasais:certCasais.checked,
    certFem:certFem.checked
  };
  const i=d.findIndex(x=>x.id===editId);
  i>=0?d[i]=t:d.push(t);
  saveStore(d);closeForm();render();
}

function edit(id){
  const t=load().find(x=>x.id===id);
  editId=id;openForm();
  Object.keys(t).forEach(k=>{if(window[k]!==undefined)window[k].value=t[k]});
  certNuru.checked=t.certNuru;
  certViv.checked=t.certViv;
  certPodo.checked=t.certPodo;
  certCasais.checked=t.certCasais;
  certFem.checked=t.certFem;
}

function del(id){
  if(confirm("Remover terapeuta?")){
    saveStore(load().filter(x=>x.id!==id));
    render();
  }
}

render();
</script>
</body>
</html>
