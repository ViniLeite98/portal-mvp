<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nova Terapeuta</title>

<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
.form-grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:14px;
}

.full { grid-column: span 4; }
.half { grid-column: span 2; }
.third { grid-column: span 1; }

.card-form{
  background:#fff;
  padding:22px;
  border-radius:14px;
  box-shadow:0 0 8px rgba(0,0,0,.05);
}

label{ font-weight:600; }
</style>
</head>

<body>

<nav class="sidebar">
  <h2>Hara Spa</h2>
  <a href="equipe.html"><i class="fa-solid fa-arrow-left"></i> Voltar</a>
</nav>

<div class="content">
  <h1 id="titulo">Nova Terapeuta</h1>
  <p>Preencha os dados da terapeuta</p>

  <div class="card-form">
    <div class="form-grid">

      <!-- Nomes -->
      <div class="half">
        <label>Nome Completo</label>
        <input id="nomeCompleto">
      </div>

      <div class="half">
        <label>Nome Profissional</label>
        <input id="nomeProfissional">
      </div>

      <!-- Dados pessoais -->
      <div class="third">
        <label>Data de Nascimento</label>
        <input type="date" id="nascimento">
      </div>

      <div class="third">
        <label>CPF</label>
        <input id="cpf">
      </div>

      <div class="third">
        <label>Email</label>
        <input id="email">
      </div>

      <div class="third">
        <label>Unidade</label>
        <select id="unidade">
          <option value="">—</option>
          <option>Hara Spa – Centro</option>
          <option>Hara Spa – Sul</option>
          <option>Hara Spa – Norte</option>
        </select>
      </div>

      <!-- Endereço -->
      <div class="full">
        <label>Endereço</label>
        <input id="endereco">
      </div>

      <!-- Contatos -->
      <div class="half">
        <label>Contato</label>
        <input id="contato">
      </div>

      <div class="half">
        <label>Contato Emergência</label>
        <input id="contatoEmergencia">
      </div>

      <!-- Pix -->
      <div class="half">
        <label>Tipo de Chave</label>
        <select id="tipoChave">
          <option value="">—</option>
          <option>CPF</option>
          <option>Email</option>
          <option>Telefone</option>
          <option>Chave Aleatória</option>
        </select>
      </div>

      <div class="half">
        <label>Chave Pix</label>
        <input id="chavePix">
      </div>

      <!-- Folga -->
      <div class="half">
        <label>Tem folga semanal?</label>
        <select id="temFolga">
          <option value="Sim">Sim</option>
          <option value="Não">Não</option>
        </select>
      </div>

      <div class="half">
        <label>Dia da Folga</label>
        <select id="diaFolga">
          <option value="">—</option>
          <option>Segunda</option>
          <option>Terça</option>
          <option>Quarta</option>
          <option>Quinta</option>
          <option>Sexta</option>
          <option>Sábado</option>
          <option>Domingo</option>
        </select>
      </div>

      <!-- Jornada / saúde -->
      <div class="third">
        <label>Horário de Entrada</label>
        <input type="time" id="horaEntrada">
      </div>

      <div class="third">
        <label>Horário de Saída</label>
        <input type="time" id="horaSaida">
      </div>

      <div class="third">
        <label>Data de Início</label>
        <input type="date" id="dataInicio">
      </div>

      <div class="third">
        <label>Tipo Sanguíneo</label>
        <select id="tipoSanguineo">
          <option value="">—</option>
          <option>A+</option><option>A-</option>
          <option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option>
          <option>O+</option><option>O-</option>
        </select>
      </div>

      <div class="third">
        <label>Status</label><br>
        <input type="radio" name="status" value="Ativo" checked> Ativo
        <input type="radio" name="status" value="Inativo"> Inativo
      </div>

    </div>

    <br>
    <button onclick="salvar()">Salvar</button>
  </div>
</div>

<script>
function apenasNumeros(v){ return v.replace(/\D/g,""); }

let terapeutas = JSON.parse(localStorage.getItem("terapeutas") || "[]");
const cpfEdicao = localStorage.getItem("editarTerapeutaCPF");

/* ===== EDIÇÃO ===== */
if (cpfEdicao) {
  const t = terapeutas.find(x => x.cpf === cpfEdicao);
  if (t) {
    titulo.innerText = "Editar Terapeuta";
    cpf.value = t.cpf;
    cpf.disabled = true;

    nomeCompleto.value = t.nomeCompleto || "";
    nomeProfissional.value = t.nomeProfissional || "";
    nascimento.value = t.nascimento || "";
    email.value = t.email || "";
    unidade.value = t.unidade || "";
    endereco.value = t.endereco || "";
    contato.value = t.contato || "";
    contatoEmergencia.value = t.contatoEmergencia || "";
    tipoChave.value = t.tipoChave || "";
    chavePix.value = t.chavePix || "";
    temFolga.value = t.temFolga || "Sim";
    diaFolga.value = t.diaFolga || "";
    horaEntrada.value = t.horaEntrada || "";
    horaSaida.value = t.horaSaida || "";
    dataInicio.value = t.dataInicio || "";
    tipoSanguineo.value = t.tipoSanguineo || "";
    document.querySelector(`input[name="status"][value="${t.status || "Ativo"}"]`).checked = true;
  }
}

/* ===== SALVAR ===== */
function salvar(){
  const cpfLimpo = apenasNumeros(cpf.value);
  if (!cpfLimpo) return alert("CPF obrigatório");

  const dados = {
    cpf: cpfLimpo,
    nomeCompleto: nomeCompleto.value,
    nomeProfissional: nomeProfissional.value,
    nascimento: nascimento.value,
    email: email.value,
    unidade: unidade.value,
    endereco: endereco.value,
    contato: contato.value,
    contatoEmergencia: contatoEmergencia.value,
    tipoChave: tipoChave.value,
    chavePix: chavePix.value,
    temFolga: temFolga.value,
    diaFolga: diaFolga.value,
    horaEntrada: horaEntrada.value,
    horaSaida: horaSaida.value,
    dataInicio: dataInicio.value,
    tipoSanguineo: tipoSanguineo.value,
    status: document.querySelector('input[name="status"]:checked').value
  };

  const idx = terapeutas.findIndex(t => t.cpf === cpfLimpo);
  if (idx >= 0) terapeutas[idx] = dados;
  else terapeutas.push(dados);

  localStorage.setItem("terapeutas", JSON.stringify(terapeutas));
  localStorage.removeItem("editarTerapeutaCPF");
  location.href = "equipe.html";
}
</script>

</body>
</html>
