<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard | Hara Spa</title>

<link rel="stylesheet"
 href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<link rel="stylesheet" href="assets/sidebar/sidebar.css">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:#f5f7fb;
}

.app{
  display:flex;
  min-height:100vh;
}

#sidebar{
  width:260px;
  flex-shrink:0;
}

.content{
  flex:1;
  padding:40px;
}

.card{
  background:#fff;
  border-radius:25px;
  padding:30px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}

.top-cards{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:30px;
  margin-bottom:40px;
}

.big-number{
  font-size:60px;
  font-weight:bold;
  margin-top:10px;
}

.label-small{
  color:#666;
  font-size:14px;
}

.workforce{
  background:#fff;
  border-radius:25px;
  padding:30px;
  display:flex;
  gap:40px;
  margin-bottom:40px;
}

.chart{
  flex:3;
}

.chart-wrapper{
  display:flex;
  align-items:flex-end;
  gap:16px;
  height:260px;
  margin-top:30px;
}

.bar-container{
  display:flex;
  flex-direction:column;
  align-items:center;
  width:40px;
}

.bar-value{
  font-size:12px;
  font-weight:600;
  margin-bottom:6px;
}

.bar{
  width:100%;
  background:linear-gradient(180deg,#6a8fd6,#4f6fb3);
  border-radius:8px 8px 0 0;
}

.bar-hour{
  margin-top:8px;
  font-size:12px;
  color:#555;
}

.work-info{
  flex:1;
  border-left:1px solid #eee;
  padding-left:30px;
}

.rank-item{
  margin-bottom:12px;
  font-size:14px;
}

.rank-top{
  font-weight:bold;
  color:#16a34a;
}

.folgas{
  background:#fff;
  border-radius:25px;
  padding:30px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}

.folga-item{
  padding:8px 0;
  border-bottom:1px solid #eee;
  font-size:14px;
}

.folga-dia{
  color:#dc2626;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="app">

<aside id="sidebar"></aside>

<main class="content">

<div class="top-cards">

  <div class="card">
    <h3>Equipe</h3>
    <div class="big-number" id="totalEquipe">0</div>
    <div class="label-small">Terapeutas ativas</div>
  </div>

  <div class="card">
    <h3>Clientes</h3>
    <div class="big-number" id="totalClientes">0</div>
    <div class="label-small">Clientes cadastrados</div>
  </div>

  <div class="card">
    <h3>Serviços</h3>
    <div class="big-number" id="totalServicos">0</div>
    <div class="label-small">Serviços ativos</div>
  </div>

</div>

<div class="workforce">

  <div class="chart">
    <h3>Força de Trabalho (por hora)</h3>
    <div class="chart-wrapper" id="bars"></div>
  </div>

  <div class="work-info">
    <h3>Carga horária (Ranking)</h3>
    <div id="cargaHoraria"></div>
  </div>

</div>

<div class="folgas">
  <h3>Dias de Folga</h3>
  <div id="listaFolgas"></div>
</div>

</main>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script src="assets/sidebar/sidebar.js"></script>

<script>
document.addEventListener("DOMContentLoaded", async function(){

const supabaseClient = window.supabase.createClient(
  "https://rymehgsoarjeecuwyhny.supabase.co",
  "SUA_ANON_KEY_AQUI"
);

/* =========================
   BUSCAR TERAPEUTAS
========================= */

const { data: terapeutas } = await supabaseClient
  .from("terapeutas")
  .select("*")
  .eq("status","Ativo");

document.getElementById("totalEquipe").innerText = terapeutas?.length || 0;

/* =========================
   CLIENTES
========================= */

const { data: clientes } = await supabaseClient
  .from("clientes")
  .select("*");

document.getElementById("totalClientes").innerText = clientes?.length || 0;

/* =========================
   SERVIÇOS
========================= */

const { data: servicos } = await supabaseClient
  .from("servicos")
  .select("*")
  .eq("status","ativo");

document.getElementById("totalServicos").innerText = servicos?.length || 0;

/* =========================
   DIAS DE FOLGA
========================= */

const folgaDiv = document.getElementById("listaFolgas");
folgaDiv.innerHTML = "";

(terapeutas || []).forEach(t=>{
  if(t.tem_folga === "Sim" && t.dia_folga){
    folgaDiv.innerHTML += `
      <div class="folga-item">
        ${t.nome_profissional} — 
        <span class="folga-dia">${t.dia_folga}</span>
      </div>
    `;
  }
});

});
</script>

</body>
</html>
