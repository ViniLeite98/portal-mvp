<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nova Terapeuta</title>

<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
.form-grid {
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:14px;
}
.full { grid-column:span 4; }
.half { grid-column:span 2; }
.third { grid-column:span 1; }

.card-form {
  background:#fff;
  padding:22px;
  border-radius:14px;
  box-shadow:0 0 8px rgba(0,0,0,.05);
}

.certificacoes {
  display:flex;
  gap:18px;
  flex-wrap:wrap;
}
</style>
</head>

<body>

<nav class="sidebar">
  <h2>Hara Spa</h2>
  <a href="equipe.html"><i class="fa-solid fa-arrow-left"></i> Voltar</a>
</nav>

<div class="content">
  <h1 id="titulo">Nova Terapeuta</h1>
  <p>Ficha cadastral completa</p>

  <div class="card-form">
    <div class="form-grid">

      <div class="half">
        <label>Nome Completo</label>
        <input id="nomeCompleto">
      </div>

      <div class="half">
        <label>Nome Profissional</label>
        <input id="nomeProfissional">
      </div>

      <div class="third">
        <label>Data de Nascimento</label>
        <input type="date" id="nascimento">
      </div>

      <div class="third">
        <label>CPF</label>
        <input id="cpf">
      </div>

      <div class="half">
        <label>Email</label>
        <input id="email">
      </div>

      <div class="third">
        <label>Unidade</label>
        <input id="unidade">
      </div>

      <div class="full">
        <label>Endereço</label>
        <input id="endereco">
      </div>

      <div class="third">
        <label>Contato</label>
        <input id="contato">
      </div>

      <div class="third">
        <label>Contato Emergência</label>
        <input id="contatoEmergencia">
      </div>

      <div class="third">
        <label>Tipo de Chave</label>
        <input id="tipoChave">
      </div>

      <div class="half">
        <label>Chave Pix</label>
        <input id="chavePix">
      </div>

      <div class="third">
        <label>Tem folga semanal?</label>
        <select id="temFolga">
          <option value="Sim">Sim</option>
          <option value="Não">Não</option>
        </select>
      </div>

      <div class="third">
        <label>Dia da Folga</label>
        <input id="diaFolga">
      </div>

      <div class="third">
        <label>Horário de Entrada</label>
        <input type="time" id="horaEntrada">
      </div>

      <div class="third">
        <label>Horário de Saída</label>
        <input type="time" id="horaSaida">
      </div>

      <div class="third">
        <label>Data de Início</label>
        <input type="date" id="dataInicio">
      </div>

      <div class="third">
        <label>Tipo Sanguíneo</label>
        <input id="tipoSanguineo">
      </div>

      <div class="third">
        <label>Status</label><br>
        <input type="radio" name="status" value="Ativo" checked> Ativo
        <input type="radio" name="status" value="Inativo"> Inativo
      </div>

      <div class="full">
        <label>Certificações</label>
        <div class="certificacoes">
          <label><input type="checkbox" value="Nuru"> Nuru</label>
          <label><input type="checkbox" value="Vivência"> Vivência</label>
          <label><input type="checkbox" value="Podolatria"> Podolatria</label>
          <label><input type="checkbox" value="Casais"> Casais</label>
          <label><input type="checkbox" value="Feminina"> Feminina</label>
        </div>
      </div>

    </div>

    <br>
    <button onclick="salvar()">Salvar</button>
  </div>
</div>

<script>
function getTerapeutas(){
  return JSON.parse(localStorage.getItem("terapeutas")||"[]");
}
function saveTerapeutas(lista){
  localStorage.setItem("terapeutas",JSON.stringify(lista));
}

const editId = localStorage.getItem("editarTerapeutaId");

if(editId){
  const t = getTerapeutas().find(x=>x.id==editId);
  if(t){
    titulo.innerText="Editar Terapeuta";
    Object.keys(t).forEach(k=>{
      if(window[k]) window[k].value=t[k];
    });

    document
      .querySelector(`input[name="status"][value="${t.status||"Ativo"}"]`)
      .checked=true;

    document
      .querySelectorAll(".certificacoes input")
      .forEach(c=>c.checked=(t.certificacoes||[]).includes(c.value));
  }
}

function salvar(){
  let terapeutas=getTerapeutas();
  const certificacoes=[...document.querySelectorAll(".certificacoes input:checked")]
    .map(c=>c.value);

  const dados={
    id: editId?Number(editId):Date.now(),
    nomeCompleto:nomeCompleto.value,
    nomeProfissional:nomeProfissional.value,
    nascimento:nascimento.value,
    cpf:cpf.value,
    email:email.value,
    unidade:unidade.value,
    endereco:endereco.value,
    contato:contato.value,
    contatoEmergencia:contatoEmergencia.value,
    tipoChave:tipoChave.value,
    chavePix:chavePix.value,
    temFolga:temFolga.value,
    diaFolga:diaFolga.value,
    horaEntrada:horaEntrada.value,
    horaSaida:horaSaida.value,
    dataInicio:dataInicio.value,
    tipoSanguineo:tipoSanguineo.value,
    status:document.querySelector('input[name="status"]:checked').value,
    certificacoes
  };

  terapeutas = editId
    ? terapeutas.map(t=>t.id==editId?dados:t)
    : [...terapeutas,dados];

  localStorage.removeItem("editarTerapeutaId");
  saveTerapeutas(terapeutas);
  location.href="equipe.html";
}
</script>

</body>
</html>
