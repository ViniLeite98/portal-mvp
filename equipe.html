<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gest√£o da Equipe</title>

<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
.header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 14px;
}

.header-row a {
  color: #6d28d9;
  font-weight: 600;
  text-decoration: none;
}

.header-row a:hover {
  text-decoration: underline;
}

.table-card {
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 0 8px rgba(0,0,0,.05);
  overflow: hidden;
}

table {
  width: 100%;
  border-collapse: collapse;
}

thead {
  background: #f3f4f6;
}

th, td {
  padding: 12px;
  text-align: left;
  font-size: 14px;
}

th {
  font-weight: 600;
}

tbody tr {
  border-bottom: 1px solid #e5e7eb;
}

.actions button {
  background: none;
  border: 1px solid #9ca3af;
  border-radius: 4px;
  padding: 4px 6px;
  cursor: pointer;
  margin-right: 4px;
}

.actions button:hover {
  background: #f3f4f6;
}
</style>
</head>

<body>

<!-- MENU -->
<nav class="sidebar">
  <h2>Hara Spa</h2>

  <a href="index.html">
    <i class="fa-solid fa-house"></i> In√≠cio
  </a>

  <a href="equipe.html" class="active">
    <i class="fa-solid fa-users"></i> Gest√£o da Equipe
  </a>

  <a href="solicitacoes.html">
    <i class="fa-solid fa-calendar-xmark"></i> Solicita√ß√µes
  </a>

  <a href="escalas.html">
    <i class="fa-solid fa-calendar-days"></i> Escalas
  </a>
</nav>

<!-- CONTE√öDO -->
<div class="content">
  <h1>Gest√£o da Equipe</h1>
  <p class="small">Gerir informa√ß√µes das terapeutas, hor√°rios e folgas</p>

  <div class="header-row">
    <div>
      <b id="contadorAtivas">0</b> terapeutas ativas
    </div>
    <a href="nova-terapeuta.html">+ Nova Terapeuta</a>
  </div>

  <div class="table-card">
    <table>
      <thead>
        <tr>
          <th>Nome Profissional</th>
          <th>Nome Completo</th>
          <th>Unidade</th>
          <th>Folga Semanal</th>
          <th>Status</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </div>
</div>

<script>
// ============================
// HELPERS (N√ÉO RESETAM)
// ============================
function getTerapeutas() {
  const data = localStorage.getItem("terapeutas");
  return data ? JSON.parse(data) : [];
}

function saveTerapeutas(lista) {
  localStorage.setItem("terapeutas", JSON.stringify(lista));
}

// ============================
// CORRE√á√ÉO DAS TERAPEUTAS ANTIGAS
// ============================
let terapeutas = getTerapeutas();
let alterou = false;

terapeutas = terapeutas.map(t => {
  if (!t.id) {
    alterou = true;
    return { ...t, id: Date.now() + Math.random() };
  }
  return t;
});

if (alterou) {
  saveTerapeutas(terapeutas);
}

// ============================
// RENDER
// ============================
function carregar() {
  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  const dados = getTerapeutas();

  // Contar somente ATIVAS
  const ativas = dados.filter(t =>
    !t.status || t.status === "Ativo"
  );
  document.getElementById("contadorAtivas").innerText = ativas.length;

  if (dados.length === 0) {
    lista.innerHTML =
      `<tr><td colspan="6">Nenhuma terapeuta cadastrada</td></tr>`;
    return;
  }

  dados.forEach(t => {
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${t.nomeProfissional || "-"}</td>
      <td>${t.nomeCompleto || "-"}</td>
      <td>${t.unidade || "-"}</td>
      <td>${t.temFolga === "Sim" ? (t.diaFolga || "-") : "N√£o"}</td>
      <td>${t.status || "-"}</td>
      <td class="actions">
        <button onclick="editar(${t.id})">‚úèÔ∏è</button>
        <button onclick="excluir(${t.id})">üóëÔ∏è</button>
      </td>
    `;

    lista.appendChild(row);
  });
}

// ============================
// A√á√ïES
// ============================
function editar(id) {
  localStorage.setItem("editarTerapeutaId", id);
  location.href = "nova-terapeuta.html";
}

function excluir(id) {
  if (!confirm("Deseja excluir esta terapeuta?")) return;

  let lista = getTerapeutas();
  lista = lista.filter(t => t.id !== id);
  saveTerapeutas(lista);
  carregar();
}

carregar();
</script>

</body>
</html>
