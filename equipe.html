<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>GestÃ£o da Equipe</title>

<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>

<!-- MENU LATERAL -->
<nav class="sidebar">
  <h2>Hara Spa</h2>

  <a href="index.html"><i class="fa-solid fa-chart-line"></i> Dashboard</a>
  <a href="equipe.html"><i class="fa-solid fa-users"></i> GestÃ£o da Equipe</a>
  <a href="solicitacoes.html"><i class="fa-solid fa-calendar-xmark"></i> Indisponibilidades</a>
  <a href="escalas.html"><i class="fa-solid fa-calendar-days"></i> Escalas</a>
  <a href="disponibilidade.html"><i class="fa-solid fa-table-cells"></i> Disponibilidade</a>
  <a href="materiais.html"><i class="fa-solid fa-boxes-stacked"></i> Materiais</a>
  <a href="financeiro.html"><i class="fa-solid fa-dollar-sign"></i> Financeiro</a>
</nav>

<!-- CONTEÃšDO -->
<div class="content">
  <h1>GestÃ£o da Equipe</h1>
  <p>Gerir informaÃ§Ãµes das terapeutas, horÃ¡rios e folgas</p>

  <a href="nova-terapeuta.html"
     style="display:inline-block;margin-bottom:15px;">
    + Nova Terapeuta
  </a>

  <table>
    <thead>
      <tr>
        <th>Nome Profissional</th>
        <th>Nome Completo</th>
        <th>Unidade</th>
        <th>Folga Semanal</th>
        <th>Status</th>
        <th>AÃ§Ãµes</th>
      </tr>
    </thead>
    <tbody id="lista"></tbody>
  </table>
</div>

<script>
function carregar() {
  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  let terapeutas =
    JSON.parse(localStorage.getItem("terapeutas")) || [];

  // ğŸ”§ CORREÃ‡ÃƒO AUTOMÃTICA PARA REGISTROS ANTIGOS (SEM ID)
  let alterou = false;
  terapeutas = terapeutas.map(t => {
    if (!t.id) {
      alterou = true;
      return { ...t, id: Date.now() + Math.random() };
    }
    return t;
  });

  if (alterou) {
    localStorage.setItem("terapeutas", JSON.stringify(terapeutas));
  }

  if (terapeutas.length === 0) {
    lista.innerHTML =
      `<tr><td colspan="6">Nenhuma terapeuta cadastrada</td></tr>`;
    return;
  }

  terapeutas.forEach(t => {
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${t.nomeProfissional || "-"}</td>
      <td>${t.nomeCompleto || "-"}</td>
      <td>${t.unidade || "-"}</td>
      <td>${t.temFolga === "Sim" ? (t.diaFolga || "-") : "NÃ£o"}</td>
      <td>${t.status || "-"}</td>
      <td>
        <button onclick="editar(${t.id})" title="Editar">âœï¸</button>
        <button onclick="excluir(${t.id})" title="Excluir">ğŸ—‘ï¸</button>
      </td>
    `;

    lista.appendChild(row);
  });
}

function editar(id) {
  localStorage.setItem("editarTerapeutaId", id);
  window.location.href = "nova-terapeuta.html";
}

function excluir(id) {
  if (!confirm("Deseja excluir esta terapeuta?")) return;

  let terapeutas =
    JSON.parse(localStorage.getItem("terapeutas")) || [];

  terapeutas = terapeutas.filter(t => t.id !== id);

  localStorage.setItem("terapeutas", JSON.stringify(terapeutas));
  carregar();
}

// ğŸš€ INICIALIZA
carregar();
</script>

</body>
</html>
